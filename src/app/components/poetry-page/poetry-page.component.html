<article class="page-container">
  <app-header />

  <section class="page-content">
    <!-- Hero Section -->
    <div class="hero-section">
      <div class="hero-icon-container">
        <span class="icon-[iconoir--flower] hero-icon"></span>
        <h1 class="hero-title">harawihark</h1>
      </div>
      <p class="hero-subtitle">
        advanced syllable-meter checker with AI-powered suggestions
      </p>
    </div>

    <!-- Editor -->
    <div class="editor-section">
      <app-poem-editor />
    </div>

     <!-- Nuevas Acciones de Generación -->
    <div class="generation-actions" *ngIf="!analyzer.result()">
      <div class="actions-grid">
        <app-button
          variant="secondary"
          size="medium"
          label="generate poem"
          icon="icon-[iconoir--magic-wand]"
          (clicked)="onGeneratePoem()"
          [disabled]="analyzer.isLoading()"
        />
        
        <app-button
          variant="outline"
          size="medium"
          label="use template"
          icon="icon-[iconoir--page]"
          (clicked)="analyzer.loadExample()"
        />
      </div>
    </div>

    <!-- Poema Generado -->
    @if (analyzer.generatedPoem(); as generated) {
      <div class="generated-section">
        <app-card padding="large">
          <div class="generated-container">
            <h3 class="generated-title">generated poem</h3>
            <div class="generated-poem">
              @for (line of generated; track $index) {
                <p class="generated-line">{{ line }}</p>
              }
            </div>
            <div class="generated-actions">
              <app-button
                variant="primary"
                size="small"
                label="use this poem"
                icon="icon-[iconoir--check]"
                (clicked)="onUseGeneratedPoem()"
              />
              <app-button
                variant="outline"
                size="small"
                label="generate another"
                icon="icon-[iconoir--refresh]"
                (clicked)="onGeneratePoem()"
              />
            </div>
          </div>
        </app-card>
      </div>
    }

    <!-- Word Suggestions Modal existente -->

    <!-- Results Section mejorada -->
    @if (analyzer.result(); as result) {
      <div class="results-section">
        <app-poem-results
          [result]="result"
          (wordSelected)="onWordSelected($event)"
        />

        <!-- Acciones de Análisis Avanzado -->
        <div class="advanced-actions">
          <div class="actions-row">
            <app-button
              variant="secondary"
              size="medium"
              label="assess quality"
              icon="icon-[iconoir--star]"
              (clicked)="onAssessQuality()"
            />
            
            <app-button
              variant="outline"
              size="medium"
              label="generate variations"
              icon="icon-[iconoir--view-grid]"
              (clicked)="onGenerateVariations()"
              [disabled]="analyzer.isLoading()"
            />
            
            <app-button
              variant="outline"
              size="medium"
              label="export poem"
              icon="icon-[iconoir--cloud-download]"
              (clicked)="onExportPoem()"
            />
          </div>
        </div>

        <!-- Calidad del Poema -->
        @if (showQuality() && analyzer.qualityMetrics()) {
          <div class="quality-section">
            <app-poem-quality [metrics]="analyzer.qualityMetrics()!" />
          </div>
        }

        <!-- Variaciones del Poema -->
        @if (showVariations() && analyzer.poemVariations().length > 0) {
          <div class="variations-section">
            <app-card padding="large">
              <div class="variations-container">
                <h3 class="variations-title">poem variations</h3>
                <div class="variations-grid">
                  @for (lineVariations of analyzer.poemVariations(); track $index; let i = $index) {
                    <div class="line-variations">
                      <h4 class="line-title">line {{ i + 1 }} alternatives</h4>
                      <div class="variation-list">
                        @for (variation of lineVariations; track $index) {
                          <div class="variation-item">
                            <span class="variation-text">{{ variation }}</span>
                            <app-button
                              variant="outline"
                              size="small"
                              label="use"
                              (clicked)="onUseVariation(i, variation)"
                            />
                          </div>
                        }
                      </div>
                    </div>
                  }
                </div>
              </div>
            </app-card>
          </div>
        }
      </div>
    } @else {
      <!-- Empty State existente -->
    }

    <!-- Info Section existente -->
  </section>
</article>