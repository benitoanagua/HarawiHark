<!-- poetry-page.component.html - VERSIÃ“N METRO UI -->
<div class="poetry-page">
  <!-- Toast Notifications -->
  <app-toast-container />

  <!-- Header -->
  <app-header />

  <!-- Panorama: Secciones Principales -->
  <app-panorama [sections]="panoramaSections">
    
    <!-- SECTION: Editor -->
    <div data-section="editor">
      <div class="section-content">
        <!-- Hero -->
        <div class="hero-section">
          <div class="hero-icon-container">
            <span class="icon-[iconoir--flower] hero-icon"></span>
            <h1 class="hero-title">harawihark</h1>
          </div>
          <p class="hero-subtitle">
            advanced syllable-meter checker with phonetic analysis
          </p>
        </div>

        <!-- Editor -->
        <app-poem-editor />

        <!-- Word Suggestions -->
        @if (analyzer.wordAlternatives(); as alternatives) {
          <div class="suggestions-wrapper">
            <app-word-suggestions
              [data]="alternatives"
              (replaceWord)="onReplaceWord($event)"
              (closeSuggestions)="onCloseSuggestions()"
            />
          </div>
        }

        <!-- Info Section -->
        <div class="info-section">
          <div class="info-content">
            <span class="icon-[iconoir--light-bulb] info-icon"></span>
            <div class="info-text">
              <h4 class="info-title">how it works</h4>
              <p class="info-description">
                Harawihark uses advanced phonetic analysis to count syllables accurately,
                detect rhyme schemes, and provide intelligent suggestions.
              </p>
              <ul class="info-features">
                <li>
                  <span class="icon-[iconoir--sound-high] feature-icon"></span>
                  Real-time syllable counting with RiTa.js
                </li>
                <li>
                  <span class="icon-[iconoir--music-double] feature-icon"></span>
                  Advanced meter analysis (iambic, trochaic, etc.)
                </li>
                <li>
                  <span class="icon-[iconoir--star] feature-icon"></span>
                  Quality assessment with detailed metrics
                </li>
                <li>
                  <span class="icon-[iconoir--book-stack] feature-icon"></span>
                  8 different poetic forms supported
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SECTION: Results -->
    <div data-section="results">
      <div class="section-content">
        @if (hasResults()) {
          <!-- Analysis in Progress -->
          @if (isAnalyzing()) {
            <div class="analysis-loading">
              <app-progress type="ring" />
              <p class="metro-body">Analyzing your poem...</p>
            </div>
          } @else {
            <!-- Pivot Tabs para Analysis Views -->
            <app-pivot
              [items]="analysisTabs()"
              [selectedId]="selectedAnalysisTab()"
              (selectedChange)="onAnalysisTabChange($event)"
            />

            <!-- Analysis Content -->
            <div class="analysis-content">
              @switch (selectedAnalysisTab()) {
                @case ('structure') {
                  <app-poem-results
                    [result]="analyzer.result()!"
                    (wordSelected)="onWordSelected($event)"
                  />
                }
                @case ('rhythm') {
                  <app-meter-analysis-section [result]="analyzer.result()!" />
                }
                @case ('quality') {
                  @if (analyzer.qualityMetrics()) {
                    <app-poem-quality [metrics]="analyzer.qualityMetrics()!" />
                  } @else {
                    <app-card padding="large">
                      <div class="quality-prompt">
                        <span class="icon-[iconoir--star] text-4xl mb-metro-md"></span>
                        <p class="metro-body mb-metro-md">
                          Click "Assess Quality" to see detailed quality metrics
                        </p>
                        <app-button
                          variant="primary"
                          label="assess quality"
                          icon="icon-[iconoir--star]"
                          (clicked)="onAssessQuality()"
                        />
                      </div>
                    </app-card>
                  }
                }
                @case ('stats') {
                  <app-quick-stats-panel [stats]="getQuickStats()" />
                }
              }
            </div>

            <!-- Analysis Actions -->
            <div class="analysis-actions">
              <app-button
                variant="primary"
                label="assess quality"
                icon="icon-[iconoir--star]"
                (clicked)="onAssessQuality()"
              />
              <app-button
                variant="outline"
                label="analyze rhythm"
                icon="icon-[iconoir--music-double]"
                (clicked)="onShowMeterAnalysis()"
              />
              <app-button
                variant="outline"
                label="export poem"
                icon="icon-[iconoir--cloud-download]"
                (clicked)="onExportPoem()"
              />
            </div>
          }
        } @else {
          <!-- Empty State -->
          <app-card padding="large">
            <div class="empty-content">
              <span class="icon-[iconoir--flower] empty-icon"></span>
              <h3 class="metro-header-4">ready to analyze</h3>
              <p class="metro-body">
                Write your poem in the editor or load an example to see analysis
              </p>
            </div>
          </app-card>
        }
      </div>
    </div>

    <!-- SECTION: History -->
    <div data-section="history">
      <div class="section-content">
        <h2 class="metro-header-3 mb-metro-lg">analysis history</h2>
        
        <!-- Placeholder: Future implementation -->
        <app-card padding="large">
          <div class="history-placeholder">
            <span class="icon-[iconoir--clock] text-5xl mb-metro-md text-onSurfaceVariant"></span>
            <h3 class="metro-header-4 mb-metro-sm">coming soon</h3>
            <p class="metro-body">
              Analysis history will be available in a future update
            </p>
          </div>
        </app-card>
      </div>
    </div>

  </app-panorama>

  <!-- Footer -->
  <app-footer />

  <!-- AppBar (Solo visible en mobile) -->
  <app-appbar
    class="lg:hidden"
    [actions]="appBarActions"
    (actionClick)="onAppBarAction($event)"
  />
</div>